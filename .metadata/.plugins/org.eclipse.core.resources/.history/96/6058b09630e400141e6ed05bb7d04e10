package handsfree;

import java.awt.AWTException;
import java.awt.Robot;
import java.awt.event.KeyEvent;
public class ControllerThread extends Thread {
    public static final boolean HEAD_ENABLED = true;
    public static final boolean SPEECH_ENABLED = false;
    private static HeadGestureThread headListener;
    private static SpeechThread speechListener;
    private static Robot robot;
    
    public ControllerThread() {
        try {
            robot = new Robot();
        } catch (AWTException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    
    private void onHeadGesture(HeadGesture headGesture) {
        System.out.println("Head gesture: " + headGesture.name());
        switch (headGesture) {
        case NOD_DOWN:
            robot.keyPress(KeyEvent.VK_PAGE_DOWN);
            robot.keyRelease(KeyEvent.VK_PAGE_DOWN);
            break;
        case NOD_UP:
            robot.keyPress(KeyEvent.VK_PAGE_UP);
            robot.keyRelease(KeyEvent.VK_PAGE_UP);
            break;
        case NONE:
            break;
        case ZOOM_IN:
            robot.keyPress()
            break;
        case ZOOM_OUT:
            break;
        }
    }
    
    private void onSpeech(String speech) {
        System.out.println(speech);
    }

    public void run() {
        headListener = new HeadGestureThread();
        if (ControllerThread.HEAD_ENABLED) {
            headListener.start();
        }
        speechListener = new SpeechThread();
        if (ControllerThread.SPEECH_ENABLED) {
            speechListener.start();
        }
        try {
            String oldSpeech = null;
            while (true) {
                Thread.sleep(100);
                String speech = speechListener.getSpeech();
                HeadGesture headGesture = headListener.getGesture();
                if (oldSpeech != null && speech != null && !oldSpeech.equals(speech)) {
                    onSpeech(speech);
                    oldSpeech = speech;
                }
                if (headGesture != null && headGesture != HeadGesture.NONE) {
                    onHeadGesture(headGesture);
                }
            }
        } catch (Exception e) {
            System.err.println("Main: " + e);
        }
    }

}
